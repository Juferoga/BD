-- 02 Julio de 2019 --
select * from CLIENTE;
select TO_CHAR(V_LIMITE_C,'$999,999,999.99') from CLIENTE where V_LIMITE_C between 2000000 and 3000000;
select * from VENTA where V_MONTO_FINAL between 5000 and 200000;
select K_VENTA, F_VENTA, V_MONTO_fINAL, CLIENTE.K_RUT AS "lol", N_NOM_CLIENTE FROM CLIENTE C,VENTA V
WHERE V_MONTO_FINAL between 5000 and 200000 AND C.K_RUT = V.K_RUT;


-----RESTART-------

SELECT * FROM VENTA_PRODUCTO WHERE K_VENTA= 288668;

-- WHITOUT NAME --
SELECT VP.K_PRODUCTO,P.N_PRODUCTO,VP.V_TOTAL_PRODUCTO,VP.K_VENTA 
FROM PRODUCTO P, VENTA_PRODUCTO VP
WHERE VP.K_PRODUCTO = P.K_PRODUCTO
AND VP.K_VENTA = 288668;

--WHIT NAME --

SELECT V.K_VENTA, P.K_PRODUCTO, N_PRODUCTO,V_CANTIDAD,C.K_RUT,C.N_NOM_CLIENTE
FROM CLIENTE C, VENTA V, PRODUCTO P, VENTA_PRODUCTO VP 
WHERE VP.K_PRODUCTO = P.K_PRODUCTO --PRODUCTO & VENTA PRODUCTO
AND VP.K_VENTA = V.K_VENTA -- VENTA PRODUCTO & CODIGO FACT
AND V.K_RUT = C.K_RUT --VENTA Y CLIENTE
AND VP.K_VENTA = 288668; -- VENTA CON CLIENTE

-- JOIN A LO MAL HECHO PERO PENSANDOLO =D --
SELECT V.K_VENTA, P.K_PRODUCTO, N_PRODUCTO,V_CANTIDAD,C.K_RUT,C.N_NOM_CLIENTE,P.V_PRECIO,TO_CHAR( V.F_VENTA, 'YYYY/MM/DD hh:mi') AS "FECHA"
-- ADD FOR ANOTHER DATE FORMAT
-- SELECT V.K_VENTA, P.K_PRODUCTO, N_PRODUCTO,V_CANTIDAD,C.K_RUT,C.N_NOM_CLIENTE,P.V_PRECIO,TO_CHAR( V.F_VENTA, 'YYYY/MM/DD') AS "FECHA"
FROM CLIENTE C, VENTA V, PRODUCTO P, VENTA_PRODUCTO VP 
WHERE VP.K_PRODUCTO = P.K_PRODUCTO 
AND VP.K_VENTA = V.K_VENTA 
AND V.K_RUT = C.K_RUT 
AND VP.K_VENTA = 288668;

-- ADD FOR DOWNER THAN 5000 --
-- AND P.V_PRECIO< 5000; 

SELECT COUNT (*) FROM VENTA_PRODUCTO;

-- EXERCISE --
-- CONSULTAS DE RESUMEN -- 

SELECT * FROM VENTA;

-- NO PUEDEN TENER O CONTENER NINIGUN DETALLE--
-- WHITOUT DETAIL--
SELECT SUM(V_MONTO_FINAL) AS "TOTAL MONEY", MAX(V_MONTO_FINAL) AS "MAX VALUE", AVG(V_MONTO_FINAL) AS "PROMEDIO VAL", COUNT (*) AS "CANTIDAD VENTAS "FROM VENTA;

-- WIHT ERROR ADD DETAIL --
SELECT SUM(V_MONTO_FINAL) AS "TOTAL MONEY", MAX(V_MONTO_FINAL) AS "MAX VALUE", AVG(V_MONTO_FINAL) AS "PROMEDIO VAL", COUNT (*) AS "CANTIDAD VENTAS", F_VENTA FROM VENTA;

-- LOOK NHOW I CAN ORDER BY GROUP--

SELECT MAX(N_APE_CLIENTE), MIN(N_APE_CLIENTE) FROM CLIENTE;
